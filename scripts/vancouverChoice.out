
R version 4.5.0 (2025-04-11) -- "How About a Twenty-Six"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # VancouverChoice.R
> # R to analyze discrete choices of developers, maybe aggregate
> # Tom Davidoff
> # Feb 5, 2026
> 
> library(data.table)
> library(ggplot2)
> library(fixest)
> library(geosphere)
> library(nnet)
> library(stargazer)

Please cite as: 

 Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.
 R package version 5.2.3. https://CRAN.R-project.org/package=stargazer 

> library(xtable)
> CUTDISTANCE <- 20 # laneay
> MINDEPTH <- 100
> MAXDEPTH <- 140
> MINWIDTH <- 30
> MAXWIDTH <- 36
> ONTARIOLON <- -123.105 # google
> 
> # Choices data
> dtChoice <- readRDS("~/OneDrive - UBC/dataProcessed/vancouverPermitLotsTracts.rds")
> print(table(dtChoice[,use]))

 duplex laneway   multi  single 
    781    1916     206    2805 
> print(head(dtChoice))
        CTUID     ROLL_NUMBER zoning_classification zoning_category
       <char>          <char>                <char>          <char>
1: 9330013.01 019237750590000 Residential Inclusive              R1
2: 9330043.02 001650034570000 Residential Inclusive              R1
3: 9330007.01 010813120730000 Residential Inclusive              R1
4: 9330017.02 023294726580000 Residential Inclusive              R1
5: 9330004.01 017824185250000 Residential Inclusive              R1
6: 9330014.02 024790254770000 Residential Inclusive              R1
   zoning_district    folioID  permitnumber permitnumbercreateddate     use
            <char>     <char>        <char>                  <IDat>  <char>
1:            R1-1 A000002L99 DB-2025-02238              2025-05-13 laneway
2:            R1-1 A0000001L4 DB-2024-04708              2024-11-27 laneway
3:            R1-1 A000001CU3 DB-2022-04382              2022-09-13 laneway
4:            R1-1 A0000032A5 DB-2021-06591              2021-12-13 laneway
5:            R1-1 A000002FXW DB-2021-06551              2021-12-12 laneway
6:            R1-1 D0000226KY DB-2025-01058              2025-03-06 laneway
   MB_effective_year MB_total_finished_area neighbourhoodDescription
              <char>                 <char>                   <char>
1:              2007                   2198                   KNIGHT
2:              1975                   2764               POINT GREY
3:              2010                   3845          SOUTH GRANVILLE
4:              1989                   2784              COLLINGWOOD
5:              1974                   2176          SOUTH VANCOUVER
6:              2006                   2947                KILLARNEY
                                         address LANDAREA landWidth landDepth
                                          <char>    <num>    <char>    <char>
1:  5835 ARGYLE STREET #3, Vancouver, BC V6P 3J8   1.1375        33       122
2:     3863 W BROADWAY #3, Vancouver, BC V6R 2C2   0.9967     58.54    108.84
3:  1675 W 59TH AVENUE #3, Vancouver, BC V6P 1Z3   2.6684        50       112
4: 5258 BURSILL STREET #3, Vancouver, BC V5R 3Z5   0.8547        33    144.45
5:            55 E 64TH AVENUE #3, Vancouver, BC   1.5554        33     115.5
6:  2293 E 49TH AVENUE #3, Vancouver, BC V5P 1T9   0.8070      36.1     217.1
               geo_point_2d   typeofwork
                     <char>       <char>
1: 49.2313344, -123.0719816 New Building
2:  49.2647127, -123.189698 New Building
3: 49.2179263, -123.1450447 New Building
4: 49.2367805, -123.0431201 New Building
5: 49.2127087, -123.1051167 New Building
6: 49.2254488, -123.0599436 New Building
                                       applicant distToSingle distToLaneway
                                          <char>        <num>         <num>
1: Patrick Chue DBA: P.Y. Chue Construction Ltd.   202.560338            NA
2:                                   William Tan     2.243065            NA
3:                                   William Tan    63.002824            NA
4:    Bhupinder (Raj) Singh DBA: Raj Home Design    60.017951            NA
5:    Bhupinder (Raj) Singh DBA: Raj Home Design     0.000000            NA
6:    Bhupinder (Raj) Singh DBA: Raj Home Design    32.534633            NA
   nearestSinglePermit nearestLanewayPermit
                <char>               <char>
1:       DB-2019-00281                 <NA>
2:       DB-2022-02694                 <NA>
3:       DB-2020-03155                 <NA>
4:       DB-2017-00302                 <NA>
5:       DB-2021-06550                 <NA>
6:       DB-2021-00712                 <NA>
> dtChoice[,landWidth:=as.numeric(landWidth)]
> dtChoice <- dtChoice[!is.na(landWidth)]
> dtChoice[,c("latitude","longitude"):=tstrsplit(geo_point_2d,","  )  ]
> dtChoice[,latitude:=as.numeric(latitude)]
> dtChoice[,longitude:=as.numeric(longitude)]
> dtChoice[,east:=longitude>ONTARIOLON]
> print(quantile(dtChoice[,landWidth],seq(.0,.9,.05)))
  0%   5%  10%  15%  20%  25%  30%  35%  40%  45%  50%  55%  60%  65%  70%  75% 
16.5 32.4 33.0 33.0 33.0 33.0 33.0 33.0 33.0 33.0 34.0 39.6 41.3 44.0 46.5 49.5 
 80%  85%  90% 
50.0 50.0 58.4 
> dtCoef <- fread("~/OneDrive - UBC/dataProcessed/neighbourhoodInteractionsVancouver.csv",na.strings=c("","NA"))
> dtCoef[,neighbourhoodDescription:=toupper(neighbourhood)]
> dtCoef[neighbourhoodDescription=="ARBUTUS RIDGE - MACKENZIE HEIGHTS",neighbourhoodDescription:="ARBUTUS/MACKENZIE HEIGHTS"]
> 
> dtCoef[neighbourhoodDescription=="MAIN & FRASER",neighbourhoodDescription:="MAIN/FRASER"]
> dtChoice <- merge(dtChoice,dtCoef,by="neighbourhoodDescription")
> 
> dtChoice[,year:=year(permitnumbercreateddate)]
> dtChoice[,latDowntown:=49.2827]
> dtChoice[,lonDowntown:=-123.1207]
> dtChoice[,distDowntown:=distGeo(dtChoice[,c("longitude","latitude")],dtChoice[,c("lonDowntown","latDowntown")])]
> dtChoice <- dtChoice[landDepth %between% c(MINDEPTH,MAXDEPTH)]
> print(names(dtChoice))
 [1] "neighbourhoodDescription" "CTUID"                   
 [3] "ROLL_NUMBER"              "zoning_classification"   
 [5] "zoning_category"          "zoning_district"         
 [7] "folioID"                  "permitnumber"            
 [9] "permitnumbercreateddate"  "use"                     
[11] "MB_effective_year"        "MB_total_finished_area"  
[13] "address"                  "LANDAREA"                
[15] "landWidth"                "landDepth"               
[17] "geo_point_2d"             "typeofwork"              
[19] "applicant"                "distToSingle"            
[21] "distToLaneway"            "nearestSinglePermit"     
[23] "nearestLanewayPermit"     "latitude"                
[25] "longitude"                "east"                    
[27] "neighbourhood"            "interactionLSF"          
[29] "medianPPSF"               "year"                    
[31] "latDowntown"              "lonDowntown"             
[33] "distDowntown"            
> # Downtown is Vancouver's primary business district, houses many arts, entertainment, and sports venues, and is close to several vibrant residential communities.
> dtChoice[,landDepth:=as.numeric(landDepth)]
> dtChoice[,landArea:=landWidth*landDepth  ]
> setnames(dtChoice,"interactionLSF","elasticity")
> dtChoice[,duplexRatio:=2*exp(elasticity*.5)]
> 
> # duplex sample
> dtChoice <- dtChoice[use!="laneway"] # not laneway only
> dtChoice[,single:=use=="single"]
> dtChoice[,duplex:=use=="duplex"]
> dtChoice[,multi:=use=="multi"]
> print(summary(dtChoice))
 neighbourhoodDescription    CTUID           ROLL_NUMBER       
 Length:2925              Length:2925        Length:2925       
 Class :character         Class :character   Class :character  
 Mode  :character         Mode  :character   Mode  :character  
                                                               
                                                               
                                                               
                                                               
 zoning_classification zoning_category    zoning_district      folioID         
 Length:2925           Length:2925        Length:2925        Length:2925       
 Class :character      Class :character   Class :character   Class :character  
 Mode  :character      Mode  :character   Mode  :character   Mode  :character  
                                                                               
                                                                               
                                                                               
                                                                               
 permitnumber       permitnumbercreateddate     use           
 Length:2925        Min.   :2017-01-03      Length:2925       
 Class :character   1st Qu.:2018-11-29      Class :character  
 Mode  :character   Median :2021-07-06      Mode  :character  
                    Mean   :2021-03-22                        
                    3rd Qu.:2023-04-03                        
                    Max.   :2025-10-17                        
                                                              
 MB_effective_year  MB_total_finished_area   address             LANDAREA     
 Length:2925        Length:2925            Length:2925        Min.   :0.3178  
 Class :character   Class :character       Class :character   1st Qu.:0.8070  
 Mode  :character   Mode  :character       Mode  :character   Median :1.2002  
                                                              Mean   :1.2950  
                                                              3rd Qu.:1.5554  
                                                              Max.   :3.5378  
                                                                              
   landWidth        landDepth     geo_point_2d        typeofwork       
 Min.   : 16.50   Min.   :100.0   Length:2925        Length:2925       
 1st Qu.: 33.00   1st Qu.:115.0   Class :character   Class :character  
 Median : 33.00   Median :122.0   Mode  :character   Mode  :character  
 Mean   : 40.01   Mean   :120.2                                        
 3rd Qu.: 48.00   3rd Qu.:123.5                                        
 Max.   :110.00   Max.   :140.0                                        
                                                                       
  applicant          distToSingle  distToLaneway     nearestSinglePermit
 Length:2925        Min.   : NA    Min.   :  0.000   Length:2925        
 Class :character   1st Qu.: NA    1st Qu.:  2.232   Class :character   
 Mode  :character   Median : NA    Median : 25.493   Mode  :character   
                    Mean   :NaN    Mean   : 38.780                      
                    3rd Qu.: NA    3rd Qu.: 56.674                      
                    Max.   : NA    Max.   :811.437                      
                    NA's   :2925   NA's   :806                          
 nearestLanewayPermit    latitude       longitude         east        
 Length:2925          Min.   :49.21   Min.   :-123.2   Mode :logical  
 Class :character     1st Qu.:49.23   1st Qu.:-123.2   FALSE:1275     
 Mode  :character     Median :49.25   Median :-123.1   TRUE :1650     
                      Mean   :49.24   Mean   :-123.1                  
                      3rd Qu.:49.26   3rd Qu.:-123.1                  
                      Max.   :49.29   Max.   :-123.0                  
                                                                      
 neighbourhood        elasticity       medianPPSF         year     
 Length:2925        Min.   :0.2234   Min.   :366.0   Min.   :2017  
 Class :character   1st Qu.:0.3837   1st Qu.:406.0   1st Qu.:2018  
 Mode  :character   Median :0.4497   Median :448.6   Median :2021  
                    Mean   :0.4788   Mean   :538.6   Mean   :2021  
                    3rd Qu.:0.6099   3rd Qu.:711.8   3rd Qu.:2023  
                    Max.   :0.7701   Max.   :827.9   Max.   :2025  
                    NA's   :49                                     
  latDowntown     lonDowntown      distDowntown     landArea    
 Min.   :49.28   Min.   :-123.1   Min.   :2927   Min.   : 2013  
 1st Qu.:49.28   1st Qu.:-123.1   1st Qu.:5295   1st Qu.: 4022  
 Median :49.28   Median :-123.1   Median :6179   Median : 4160  
 Mean   :49.28   Mean   :-123.1   Mean   :6166   Mean   : 4821  
 3rd Qu.:49.28   3rd Qu.:-123.1   3rd Qu.:7084   3rd Qu.: 5600  
 Max.   :49.28   Max.   :-123.1   Max.   :9857   Max.   :13805  
                                                                
  duplexRatio      single          duplex          multi        
 Min.   :2.236   Mode :logical   Mode :logical   Mode :logical  
 1st Qu.:2.423   FALSE:806       FALSE:2263      FALSE:2781     
 Median :2.504   TRUE :2119      TRUE :662       TRUE :144      
 Mean   :2.548                                                  
 3rd Qu.:2.713                                                  
 Max.   :2.939                                                  
 NA's   :49                                                     
> dtChoice[,multiplex:=use=="multi"]
> MINWIDEWIDTH <- 40
> dtWide <- dtChoice[landWidth>MINWIDEWIDTH]
> dtChoice <- dtChoice[landWidth %between% c(MINWIDTH,MAXWIDTH)]
> 
> # laneway
> dtChoice[use=="single",laneway:=distToLaneway<CUTDISTANCE]
> print(mean(dtChoice[use=="single",laneway]))
[1] 0.4348214
> print((dtChoice[use=="single",mean(laneway),by="east"]))
     east        V1
   <lgcl>     <num>
1:  FALSE 0.3925926
2:   TRUE 0.4587413
> print((dtChoice[year>2023 & use=="single",mean(laneway),by="east"]))
     east        V1
   <lgcl>     <num>
1:  FALSE 0.7058824
2:   TRUE 0.6444444
> 
> ggplot(dtChoice[use=="single"],aes(x=longitude,y=latitude,color=laneway)) + geom_point()
> ggsave("text/lanewayMap.png")
Saving 7 x 7 in image
> 
> ggplot(dtChoice,aes(x=longitude,y=latitude,color=single)) + geom_point()
> ggsave("text/singleMap.png")
Saving 7 x 7 in image
> 
> ggplot(dtChoice[year>2018],aes(x=longitude,y=latitude,color=duplex)) + geom_point()
> ggsave("text/duplexMap.png")
Saving 7 x 7 in image
> 
> ggplot(dtWide[year>2023],aes(x=longitude,y=latitude,color=multi)) + geom_point()
> ggsave("text/multiMapWide.png")
Saving 7 x 7 in image
> 
> 
> 
> 
> 
> 
> 
> print(cor(dtChoice[year>=2019 & use=="single",.(laneway,elasticity,medianPPSF,longitude,east)],use="complete.obs"))
               laneway elasticity  medianPPSF   longitude        east
laneway     1.00000000 -0.1564642 -0.08197568  0.07272915  0.05828077
elasticity -0.15646423  1.0000000  0.78658147 -0.82872648 -0.65570921
medianPPSF -0.08197568  0.7865815  1.00000000 -0.94123863 -0.90805343
longitude   0.07272915 -0.8287265 -0.94123863  1.00000000  0.85088027
east        0.05828077 -0.6557092 -0.90805343  0.85088027  1.00000000
> print(summary(feols(laneway ~  medianPPSF + landWidth, data=dtChoice[year %between% c(2017,2018)], cluster="neighbourhoodDescription")))
NOTE: 1 observation removed because of NA values (LHS: 1).
OLS estimation, Dep. Var.: laneway
Observations: 407
Standard-errors: Clustered (neighbourhoodDescription) 
             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  1.036333   0.968292  1.070268 0.298641    
medianPPSF  -0.000364   0.000160 -2.275456 0.035338 *  
landWidth   -0.017914   0.029636 -0.604464 0.553079    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.436743   Adj. R2: 0.010806
> print(summary(feols(laneway ~  medianPPSF + landWidth + longitude, data=dtChoice[year %between% c(2017,2018)], cluster="neighbourhoodDescription")))
NOTE: 1 observation removed because of NA values (LHS: 1).
OLS estimation, Dep. Var.: laneway
Observations: 407
Standard-errors: Clustered (neighbourhoodDescription) 
              Estimate Std. Error   t value Pr(>|t|) 
(Intercept) -64.493385 173.679087 -0.371337  0.71472 
medianPPSF   -0.000540   0.000494 -1.094643  0.28811 
landWidth    -0.015644   0.032562 -0.480450  0.63669 
longitude    -0.532453   1.408699 -0.377975  0.70987 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.436632   Adj. R2: 0.008859
> print(summary(feols(laneway ~ elasticity + medianPPSF + landWidth, data=dtChoice[year %between% c(2017,2018)], cluster="neighbourhoodDescription")))
NOTE: 1 observation removed because of NA values (LHS: 1).
OLS estimation, Dep. Var.: laneway
Observations: 407
Standard-errors: Clustered (neighbourhoodDescription) 
             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  1.023207   0.980701  1.043343 0.310600    
elasticity   0.299314   0.253802  1.179319 0.253624    
medianPPSF  -0.000596   0.000244 -2.446680 0.024914 *  
landWidth   -0.018028   0.029948 -0.601979 0.554696    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.43608   Adj. R2: 0.011365
> print(summary(feols(laneway ~ elasticity + medianPPSF + landWidth + longitude, data=dtChoice[year %between% c(2017,2018)], cluster="neighbourhoodDescription")))
NOTE: 1 observation removed because of NA values (LHS: 1).
OLS estimation, Dep. Var.: laneway
Observations: 407
Standard-errors: Clustered (neighbourhoodDescription) 
             Estimate Std. Error   t value Pr(>|t|) 
(Intercept) 25.882109 218.024093  0.118712  0.90682 
elasticity   0.323705   0.309641  1.045419  0.30967 
medianPPSF  -0.000548   0.000522 -1.049373  0.30789 
landWidth   -0.018898   0.034266 -0.551514  0.58806 
longitude    0.201997   1.767803  0.114264  0.91029 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.436068   Adj. R2: 0.008958
> print(summary(feols(laneway ~ elasticity +  landWidth + longitude, data=dtChoice[year %between% c(2017,2018)], cluster="neighbourhoodDescription")))
NOTE: 1 observation removed because of NA values (LHS: 1).
OLS estimation, Dep. Var.: laneway
Observations: 407
Standard-errors: Clustered (neighbourhoodDescription) 
              Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 201.470811 112.020792  1.798513 0.088888 .  
elasticity    0.315851   0.371059  0.851216 0.405832    
landWidth    -0.025227   0.030006 -0.840729 0.411529    
longitude     1.628930   0.906711  1.796526 0.089213 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.437009   Adj. R2: 0.007147
> 
> 
> # Duplex
> print(cor(dtChoice[year>=2019 & year<=2023,.(duplex,elasticity,medianPPSF,longitude,distDowntown,east)],use="complete.obs"))
                  duplex elasticity medianPPSF  longitude distDowntown
duplex        1.00000000 -0.1534498 -0.2018298  0.2212335   0.01424803
elasticity   -0.15344985  1.0000000  0.7795313 -0.8202031  -0.29306661
medianPPSF   -0.20182976  0.7795313  1.0000000 -0.9386852  -0.18929561
longitude     0.22123352 -0.8202031 -0.9386852  1.0000000   0.15940931
distDowntown  0.01424803 -0.2930666 -0.1892956  0.1594093   1.00000000
east          0.18342852 -0.6554678 -0.9110430  0.8569085   0.22376415
                   east
duplex        0.1834285
elasticity   -0.6554678
medianPPSF   -0.9110430
longitude     0.8569085
distDowntown  0.2237641
east          1.0000000
> print(dtChoice[year>=2019 & year<=2023,mean(duplex),by=east])
     east        V1
   <lgcl>     <num>
1:  FALSE 0.2033898
2:   TRUE 0.3899083
> 
> print(cor(dtWide[year>=2019 & year<=2023,.(duplex,elasticity,medianPPSF,longitude,distDowntown)],use="complete.obs"))
                 duplex elasticity medianPPSF  longitude distDowntown
duplex        1.0000000 -0.2008186 -0.2985885  0.2711123    0.1165813
elasticity   -0.2008186  1.0000000  0.8200904 -0.8643178   -0.3724419
medianPPSF   -0.2985885  0.8200904  1.0000000 -0.9560765   -0.3981801
longitude     0.2711123 -0.8643178 -0.9560765  1.0000000    0.3922036
distDowntown  0.1165813 -0.3724419 -0.3981801  0.3922036    1.0000000
> print(summary(feols(duplex ~  medianPPSF + landWidth, data=dtChoice[year %between% c(2019,2023)], cluster="neighbourhoodDescription")))
OLS estimation, Dep. Var.: duplex
Observations: 949
Standard-errors: Clustered (neighbourhoodDescription) 
             Estimate Std. Error  t value   Pr(>|t|)    
(Intercept) -1.056229   0.687094 -1.53724 0.13990510    
medianPPSF  -0.000663   0.000171 -3.87111 0.00095082 ***
landWidth    0.052095   0.021614  2.41027 0.02568712 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.459864   Adj. R2: 0.044329
> print(summary(feols(duplex ~  medianPPSF + landWidth + longitude, data=dtChoice[year %between% c(2019,2023)], cluster="neighbourhoodDescription")))
OLS estimation, Dep. Var.: duplex
Observations: 949
Standard-errors: Clustered (neighbourhoodDescription) 
              Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 262.777053 175.717919 1.495448 0.150411    
medianPPSF    0.000076   0.000524 0.144708 0.886390    
landWidth     0.047733   0.021454 2.224866 0.037762 *  
longitude     2.145131   1.427899 1.502299 0.148645    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.458172   Adj. R2: 0.050344
> print(summary(feols(duplex ~ elasticity + medianPPSF + landWidth, data=dtChoice[year %between% c(2019,2023)], cluster="neighbourhoodDescription")))
NOTE: 4 observations removed because of NA values (RHS: 4).
OLS estimation, Dep. Var.: duplex
Observations: 945
Standard-errors: Clustered (neighbourhoodDescription) 
             Estimate Std. Error   t value  Pr(>|t|)    
(Intercept) -1.180234   0.714518 -1.651790 0.1150083    
elasticity   0.079984   0.203288  0.393452 0.6983660    
medianPPSF  -0.000724   0.000237 -3.062053 0.0064148 ** 
landWidth    0.055674   0.022452  2.479673 0.0226910 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.459808   Adj. R2: 0.04404
> print(summary(feols(duplex ~ elasticity + medianPPSF + landWidth + longitude, data=dtChoice[year %between% c(2019,2023)], cluster="neighbourhoodDescription")))
NOTE: 4 observations removed because of NA values (RHS: 4).
OLS estimation, Dep. Var.: duplex
Observations: 945
Standard-errors: Clustered (neighbourhoodDescription) 
              Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 349.497714 166.758161 2.095836 0.049723 *  
elasticity    0.314812   0.292322 1.076937 0.294993    
medianPPSF    0.000073   0.000457 0.160512 0.874172    
landWidth     0.052946   0.022304 2.373836 0.028301 *  
longitude     2.852186   1.354774 2.105285 0.048801 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.457348   Adj. R2: 0.053235
> 
> # Wide Lot multi
> print(cor(dtWide[year>=2024 ,.(multi,landWidth,longitude,distDowntown,east)],use="complete.obs"))
                   multi   landWidth  longitude distDowntown       east
multi         1.00000000 -0.12848330  0.2402398   0.01536864  0.2421240
landWidth    -0.12848330  1.00000000 -0.4022182  -0.02411683 -0.4566771
longitude     0.24023985 -0.40221825  1.0000000   0.31402605  0.8878719
distDowntown  0.01536864 -0.02411683  0.3140260   1.00000000  0.2938381
east          0.24212400 -0.45667712  0.8878719   0.29383808  1.0000000
> print(summary(feols(multi ~  longitude + landWidth, data=dtChoice[year %between% c(2024,2026)], cluster="neighbourhoodDescription")))
OLS estimation, Dep. Var.: multi
Observations: 291
Standard-errors: Clustered (neighbourhoodDescription) 
              Estimate Std. Error t value  Pr(>|t|)    
(Intercept) 138.306194  39.353953 3.51442 0.0024762 ** 
longitude     1.145778   0.318939 3.59246 0.0020818 ** 
landWidth     0.089399   0.030114 2.96870 0.0082261 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.391641   Adj. R2: 0.044505
> print(summary(feols(multi ~  medianPPSF + landWidth + longitude, data=dtChoice[year %between% c(2024,2026)], cluster="neighbourhoodDescription")))
OLS estimation, Dep. Var.: multi
Observations: 291
Standard-errors: Clustered (neighbourhoodDescription) 
                Estimate Std. Error  t value  Pr(>|t|)    
(Intercept) 138.75137424 128.272124 1.081695 0.2936672    
medianPPSF    0.00000138   0.000393 0.003503 0.9972438    
landWidth     0.08939178   0.030802 2.902179 0.0095006 ** 
longitude     1.14939828   1.040728 1.104418 0.2839573    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.391641   Adj. R2: 0.041175
> print(summary(feols(duplex ~ elasticity + medianPPSF + landWidth, data=dtChoice[year %between% c(2024,2026)], cluster="neighbourhoodDescription")))
NOTE: 1 observation removed because of NA values (RHS: 1).
OLS estimation, Dep. Var.: duplex
Observations: 290
Standard-errors: Clustered (neighbourhoodDescription) 
             Estimate Std. Error  t value  Pr(>|t|)    
(Intercept)  2.431889   1.439816  1.68903 0.1094698    
elasticity   0.983147   0.336271  2.92368 0.0094747 ** 
medianPPSF  -0.000573   0.000301 -1.90020 0.0745038 .  
landWidth   -0.063243   0.043812 -1.44349 0.1670571    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.486216   Adj. R2: 0.041538
> print(summary(feols(duplex ~ elasticity + medianPPSF + landWidth + longitude, data=dtChoice[year %between% c(2024,2026)], cluster="neighbourhoodDescription")))
NOTE: 1 observation removed because of NA values (RHS: 1).
OLS estimation, Dep. Var.: duplex
Observations: 290
Standard-errors: Clustered (neighbourhoodDescription) 
             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 72.603560 367.322957  0.197656 0.845658    
elasticity   1.018996   0.401103  2.540485 0.021119 *  
medianPPSF  -0.000403   0.000958 -0.420545 0.679355    
landWidth   -0.063800   0.044836 -1.422953 0.172842    
longitude    0.570732   2.984478  0.191233 0.850608    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.48613   Adj. R2: 0.038517
> 
> print(dtChoice[use=="single",mean(east),by="year"])
    year        V1
   <int>     <num>
1:  2020 0.6321839
2:  2023 0.6132075
3:  2022 0.6818182
4:  2017 0.6488889
5:  2021 0.6086957
6:  2019 0.6290323
7:  2018 0.6868132
8:  2025 0.3870968
9:  2024 0.6875000
> print(table(dtChoice[,use]))

duplex  multi single 
   469     59   1120 
> print(table(dtChoice[,east]))

FALSE  TRUE 
  539  1109 
> print(summary(feols(laneway~ east | year,data=dtChoice[use =="single" & year>=2019])))
OLS estimation, Dep. Var.: laneway
Observations: 713
Fixed-effects: year: 7
Standard-errors: Clustered (year) 
         Estimate Std. Error t value Pr(>|t|) 
eastTRUE 0.068329   0.036393 1.87753  0.10953 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.47163     Adj. R2: 0.097506
                Within R2: 0.004838
> print(summary(feols(duplex~ east | year,data=dtChoice[year>=2019])))
OLS estimation, Dep. Var.: duplex
Observations: 1,240
Fixed-effects: year: 7
Standard-errors: Clustered (year) 
         Estimate Std. Error t value Pr(>|t|)    
eastTRUE 0.114743     0.0543 2.11314 0.079029 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.456844     Adj. R2: 0.106744
                 Within R2: 0.013457
> print(summary(feols(duplex~ east | year,data=dtChoice[year>=2019 & year<2024])))
OLS estimation, Dep. Var.: duplex
Observations: 949
Fixed-effects: year: 5
Standard-errors: Clustered (year) 
         Estimate Std. Error t value  Pr(>|t|)    
eastTRUE 0.171812   0.033979 5.05647 0.0071983 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.440425     Adj. R2: 0.120629
                 Within R2: 0.031435
> print(summary(feols(multi~ east | year,data=dtChoice[year>=2024])))
OLS estimation, Dep. Var.: multi
Observations: 291
Fixed-effects: year: 2
Standard-errors: Clustered (year) 
         Estimate Std. Error t value Pr(>|t|)    
eastTRUE 0.132752   0.012743 10.4177 0.060923 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.395698     Adj. R2: 0.024607
                 Within R2: 0.024795
> print(summary(feols(multi~ east | year,data=dtWide[year>=2024])))
OLS estimation, Dep. Var.: multi
Observations: 201
Fixed-effects: year: 2
Standard-errors: Clustered (year) 
         Estimate Std. Error t value Pr(>|t|)    
eastTRUE 0.238169   0.014549 16.3696 0.038842 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.456362     Adj. R2: 0.053337
                 Within R2: 0.058926
> 
> print(summary(feols(laneway~ longitude | year,data=dtChoice[use =="single" & year>=2019])))
OLS estimation, Dep. Var.: laneway
Observations: 713
Fixed-effects: year: 7
Standard-errors: Clustered (year) 
          Estimate Std. Error t value Pr(>|t|) 
longitude 0.653541    0.36758 1.77796  0.12573 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.47147     Adj. R2: 0.098116
                Within R2: 0.005511
> print(summary(feols(duplex~ longitude | year,data=dtChoice[year>=2019])))
OLS estimation, Dep. Var.: duplex
Observations: 1,240
Fixed-effects: year: 7
Standard-errors: Clustered (year) 
          Estimate Std. Error t value Pr(>|t|)    
longitude  1.17605   0.581162 2.02361 0.089451 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.455625     Adj. R2: 0.111503
                 Within R2: 0.018713
> print(summary(feols(duplex~ longitude | year,data=dtChoice[year>=2019 & year<2024])))
OLS estimation, Dep. Var.: duplex
Observations: 949
Fixed-effects: year: 5
Standard-errors: Clustered (year) 
          Estimate Std. Error t value Pr(>|t|)    
longitude  1.80343   0.392131 4.59904 0.010038 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.437221     Adj. R2: 0.133374
                 Within R2: 0.045473
> print(summary(feols(multi~ longitude | year,data=dtChoice[year>=2024])))
OLS estimation, Dep. Var.: multi
Observations: 291
Fixed-effects: year: 2
Standard-errors: Clustered (year) 
          Estimate Std. Error t value Pr(>|t|) 
longitude  1.33286   0.238118 5.59746  0.11255 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.393843     Adj. R2: 0.033733
                 Within R2: 0.033919
> print(summary(feols(multi~ longitude | year,data=dtWide[year>=2024])))
OLS estimation, Dep. Var.: multi
Observations: 201
Fixed-effects: year: 2
Standard-errors: Clustered (year) 
          Estimate Std. Error t value Pr(>|t|) 
longitude  2.01641   0.588181 3.42821  0.18069 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.456635     Adj. R2: 0.052202
                 Within R2: 0.057797
> 
> 
> for (u in c("single","duplex","multi")) {
+ 	print(u)
+ 	print(dtChoice[order(year),mean(use==u),by=c("year","east")])
+ 	print(dtWide[order(year),mean(use==u),by=c("year","east")])
+ }
[1] "single"
     year   east        V1
    <int> <lgcl>     <num>
 1:  2017  FALSE 1.0000000
 2:  2017   TRUE 1.0000000
 3:  2018  FALSE 1.0000000
 4:  2018   TRUE 0.9920635
 5:  2019  FALSE 1.0000000
 6:  2019   TRUE 0.9629630
 7:  2020  FALSE 0.9411765
 8:  2020   TRUE 0.8088235
 9:  2021  FALSE 0.7641509
10:  2021   TRUE 0.5294118
11:  2022  FALSE 0.7142857
12:  2022   TRUE 0.5357143
13:  2023  FALSE 0.6833333
14:  2023   TRUE 0.5118110
15:  2024  FALSE 0.2830189
16:  2024   TRUE 0.2682927
17:  2025  FALSE 0.3454545
18:  2025   TRUE 0.2000000
     year   east        V1
    <int> <lgcl>     <num>
 1:  2017  FALSE 1.0000000
 2:  2017   TRUE 1.0000000
 3:  2018  FALSE 1.0000000
 4:  2018   TRUE 1.0000000
 5:  2019  FALSE 0.9324324
 6:  2019   TRUE 0.9500000
 7:  2020  FALSE 0.8852459
 8:  2020   TRUE 0.8421053
 9:  2021  FALSE 0.8095238
10:  2021   TRUE 0.4380952
11:  2022  FALSE 0.9245283
12:  2022   TRUE 0.7000000
13:  2023  FALSE 0.9148936
14:  2023   TRUE 0.6666667
15:  2024  FALSE 0.6533333
16:  2024   TRUE 0.3809524
17:  2025  FALSE 0.4814815
18:  2025   TRUE 0.1666667
[1] "duplex"
     year   east          V1
    <int> <lgcl>       <num>
 1:  2017  FALSE 0.000000000
 2:  2017   TRUE 0.000000000
 3:  2018  FALSE 0.000000000
 4:  2018   TRUE 0.007936508
 5:  2019  FALSE 0.000000000
 6:  2019   TRUE 0.037037037
 7:  2020  FALSE 0.058823529
 8:  2020   TRUE 0.191176471
 9:  2021  FALSE 0.235849057
10:  2021   TRUE 0.470588235
11:  2022  FALSE 0.285714286
12:  2022   TRUE 0.464285714
13:  2023  FALSE 0.316666667
14:  2023   TRUE 0.488188976
15:  2024  FALSE 0.641509434
16:  2024   TRUE 0.512195122
17:  2025  FALSE 0.472727273
18:  2025   TRUE 0.500000000
     year   east         V1
    <int> <lgcl>      <num>
 1:  2017  FALSE 0.00000000
 2:  2017   TRUE 0.00000000
 3:  2018  FALSE 0.00000000
 4:  2018   TRUE 0.00000000
 5:  2019  FALSE 0.06756757
 6:  2019   TRUE 0.05000000
 7:  2020  FALSE 0.09836066
 8:  2020   TRUE 0.15789474
 9:  2021  FALSE 0.17460317
10:  2021   TRUE 0.56190476
11:  2022  FALSE 0.05660377
12:  2022   TRUE 0.30000000
13:  2023  FALSE 0.06382979
14:  2023   TRUE 0.25000000
15:  2024  FALSE 0.12000000
16:  2024   TRUE 0.16666667
17:  2025  FALSE 0.24074074
18:  2025   TRUE 0.30000000
[1] "multi"
     year   east        V1
    <int> <lgcl>     <num>
 1:  2017  FALSE 0.0000000
 2:  2017   TRUE 0.0000000
 3:  2018  FALSE 0.0000000
 4:  2018   TRUE 0.0000000
 5:  2019  FALSE 0.0000000
 6:  2019   TRUE 0.0000000
 7:  2020  FALSE 0.0000000
 8:  2020   TRUE 0.0000000
 9:  2021  FALSE 0.0000000
10:  2021   TRUE 0.0000000
11:  2022  FALSE 0.0000000
12:  2022   TRUE 0.0000000
13:  2023  FALSE 0.0000000
14:  2023   TRUE 0.0000000
15:  2024  FALSE 0.0754717
16:  2024   TRUE 0.2195122
17:  2025  FALSE 0.1818182
18:  2025   TRUE 0.3000000
     year   east         V1
    <int> <lgcl>      <num>
 1:  2017  FALSE 0.00000000
 2:  2017   TRUE 0.00000000
 3:  2018  FALSE 0.00000000
 4:  2018   TRUE 0.00000000
 5:  2019  FALSE 0.00000000
 6:  2019   TRUE 0.00000000
 7:  2020  FALSE 0.01639344
 8:  2020   TRUE 0.00000000
 9:  2021  FALSE 0.01587302
10:  2021   TRUE 0.00000000
11:  2022  FALSE 0.01886792
12:  2022   TRUE 0.00000000
13:  2023  FALSE 0.02127660
14:  2023   TRUE 0.08333333
15:  2024  FALSE 0.22666667
16:  2024   TRUE 0.45238095
17:  2025  FALSE 0.27777778
18:  2025   TRUE 0.53333333
> dtSingle <- dtChoice[use=="single"]
> dtSingle[distToLaneway<CUTDISTANCE & use=="single",use:="singleLaneway"]
> dtSingle[distToLaneway>=CUTDISTANCE & use=="single",use:="singleOnly"]
> 
> for (u in c("singleLaneway","singleOnly")) {
+ 	print(u)
+ 	print(dtSingle[order(year),mean(use==u),by=c("year","east")])
+ }
[1] "singleLaneway"
     year   east        V1
    <int> <lgcl>     <num>
 1:  2017  FALSE 0.2658228
 2:  2017   TRUE 0.3835616
 3:  2018  FALSE 0.0877193
 4:  2018   TRUE 0.2000000
 5:  2019  FALSE 0.1956522
 6:  2019   TRUE 0.2051282
 7:  2020  FALSE 0.5000000
 8:  2020   TRUE 0.7454545
 9:  2021  FALSE 0.5308642
10:  2021   TRUE 0.6587302
11:  2022  FALSE 0.6000000
12:  2022   TRUE 0.5866667
13:  2023  FALSE 0.4878049
14:  2023   TRUE 0.5230769
15:  2024  FALSE 0.6666667
16:  2024   TRUE 0.6363636
17:  2025  FALSE 0.7368421
18:  2025   TRUE 0.6666667
[1] "singleOnly"
     year   east        V1
    <int> <lgcl>     <num>
 1:  2017  FALSE 0.7341772
 2:  2017   TRUE 0.6164384
 3:  2018  FALSE 0.9122807
 4:  2018   TRUE 0.8000000
 5:  2019  FALSE 0.8043478
 6:  2019   TRUE 0.7948718
 7:  2020  FALSE 0.5000000
 8:  2020   TRUE 0.2545455
 9:  2021  FALSE 0.4691358
10:  2021   TRUE 0.3412698
11:  2022  FALSE 0.4000000
12:  2022   TRUE 0.4133333
13:  2023  FALSE 0.5121951
14:  2023   TRUE 0.4769231
15:  2024  FALSE 0.3333333
16:  2024   TRUE 0.3636364
17:  2025  FALSE 0.2631579
18:  2025   TRUE 0.3333333
> 
> 
> # plot with bubbles proportional to nobs
> dPlot <- dtChoice[,.(elasticity=mean(elasticity),medianPPSF=mean(medianPPSF),nobs=.N),by="neighbourhoodDescription"]
> ggplot(dPlot, aes(x=medianPPSF, y=elasticity, size=nobs)) + geom_point()
Warning message:
Removed 1 row containing missing values or values outside the scale range
(`geom_point()`). 
> ggsave("text/elasticityMedianPrice.png")
Saving 7 x 7 in image
Warning message:
Removed 1 row containing missing values or values outside the scale range
(`geom_point()`). 
> 
> # Multiplex
> print(cor(dtChoice[year>=2024 ,.(multiplex,elasticity,medianPPSF,east)],use="complete.obs"))
            multiplex elasticity medianPPSF       east
multiplex   1.0000000 -0.2055050 -0.1603848  0.1500728
elasticity -0.2055050  1.0000000  0.7679491 -0.6696486
medianPPSF -0.1603848  0.7679491  1.0000000 -0.9369086
east        0.1500728 -0.6696486 -0.9369086  1.0000000
> print(cor(dtWide[year>=2024 ,.(multiplex,elasticity,medianPPSF,east)],use="complete.obs"))
            multiplex elasticity medianPPSF       east
multiplex   1.0000000 -0.1674175 -0.2375618  0.2296074
elasticity -0.1674175  1.0000000  0.7818060 -0.6145684
medianPPSF -0.2375618  0.7818060  1.0000000 -0.9140439
east        0.2296074 -0.6145684 -0.9140439  1.0000000
> print(dtChoice[year>=2024,mean(multiplex),by=east])
     east        V1
   <lgcl>     <num>
1:  FALSE 0.1296296
2:   TRUE 0.2459016
> print(dtWide[year>=2024,mean(multiplex),by=east])
     east        V1
   <lgcl>     <num>
1:  FALSE 0.2480620
2:   TRUE 0.4861111
> 
> 
> print(summary(feols(multiplex ~  medianPPSF + landWidth, data=dtChoice[year %between% c(2024,2026)], cluster="neighbourhoodDescription")))
OLS estimation, Dep. Var.: multiplex
Observations: 291
Standard-errors: Clustered (neighbourhoodDescription) 
             Estimate Std. Error  t value  Pr(>|t|)    
(Intercept) -2.621629   0.968626 -2.70654 0.0144494 *  
medianPPSF  -0.000395   0.000128 -3.09650 0.0062268 ** 
landWidth    0.091941   0.029588  3.10738 0.0060803 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.392137   Adj. R2: 0.042085
> print(summary(feols(multiplex ~ elasticity + medianPPSF + landWidth, data=dtChoice[year %between% c(2024,2026)], cluster="neighbourhoodDescription")))
NOTE: 1 observation removed because of NA values (RHS: 1).
OLS estimation, Dep. Var.: multiplex
Observations: 290
Standard-errors: Clustered (neighbourhoodDescription) 
             Estimate Std. Error   t value  Pr(>|t|)    
(Intercept) -2.275830   0.969312 -2.347883 0.0312426 *  
elasticity  -0.447518   0.119876 -3.733185 0.0016542 ** 
medianPPSF  -0.000072   0.000163 -0.443521 0.6629817    
landWidth    0.082878   0.029656  2.794676 0.0124440 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.38736   Adj. R2: 0.052364
> 
> # All plex
> dtChoice[,single:=use=="single"]
> print(summary(feols(single ~  medianPPSF + landWidth, data=dtChoice[year %between% c(2019,2026)], cluster="neighbourhoodDescription")))
OLS estimation, Dep. Var.: single
Observations: 1,240
Standard-errors: Clustered (neighbourhoodDescription) 
             Estimate Std. Error  t value  Pr(>|t|)    
(Intercept)  1.546499   0.556542  2.77876 0.0115881 *  
medianPPSF   0.000465   0.000160  2.90554 0.0087452 ** 
landWidth   -0.036564   0.017902 -2.04243 0.0545155 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.488973   Adj. R2: 0.020024
> print(summary(feols(single ~ elasticity + medianPPSF + landWidth + longitude, data=dtChoice[year %between% c(2019,2026)], cluster="neighbourhoodDescription")))
NOTE: 5 observations removed because of NA values (RHS: 5).
OLS estimation, Dep. Var.: single
Observations: 1,235
Standard-errors: Clustered (neighbourhoodDescription) 
               Estimate Std. Error   t value Pr(>|t|)    
(Intercept) -327.462551 194.740941 -1.681529 0.109024    
elasticity    -0.505438   0.302531 -1.670696 0.111173    
medianPPSF    -0.000066   0.000504 -0.131260 0.896950    
landWidth     -0.041223   0.021008 -1.962226 0.064552 .  
longitude     -2.678072   1.581447 -1.693431 0.106705    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.486112   Adj. R2: 0.029939
> 
> print(table(dtChoice[,use]))

duplex  multi single 
   469     59   1120 
> 
> # Income by census tract
> dtIncome <- fread("~/OneDrive - UBC/dataRaw/9810005801_databaseLoadingData.csv",
+   select = c("GEO", "DGUID", "Household income statistics (6)", "VALUE")
+ )
> dtIncome <- dtIncome[grepl("Vancouver", GEO)]
> setnames(dtIncome, c("DGUID", "Household income statistics (6)", "VALUE"), c("DGUID", "incomeStat", "medianIncome"))
> dtIncome <- dtIncome[incomeStat == "Median household total income (2020) (2020 constant dollars)"]
> dtIncome[, tract := substr(DGUID, 13, 19)]
> 
> dtChoice[,tract:=substring(CTUID,4,10)]
> a <- nrow(dtChoice)
> dtChoice <- merge(dtChoice,dtIncome,by="tract")
> 
> 
> 
> # Mean price, single vs duplex premium and elasticity of ppsf among single/duplex, mean price by neighbourhood
> 
> dtElasticityN <- fread("~/OneDrive - UBC/dataProcessed/neighbourhoodInteractionsVancouver.csv")
> dtPriceCT <- fread("~/OneDrive - UBC/dataProcessed/tractMeansVancouver.csv",colClasses=c(CTNAME="character"))
> print(head(dtElasticityN))
                       neighbourhood interactionLSF medianPPSF
                              <char>          <num>      <num>
1:                        Point Grey      0.6997299   827.9051
2:                         Kitsilano      0.6953877   653.0926
3:                            Dunbar      0.6679352   753.3525
4: Arbutus Ridge - Mackenzie Heights      0.5430374   766.7416
5:                        Kerrisdale      0.6098701   711.7624
6:                        Southlands             NA   622.6539
> print(head(dtPriceCT))
    CTNAME  meanPPSF medianPPSF
    <char>     <num>      <num>
1: 0044.00 1113.6812  1127.7303
2: 0043.01  955.0606   923.8692
3: 0043.02  994.7940   980.7295
4: 0042.00  840.7464   801.9324
5: 0045.01 1012.6041   960.4759
6: 0045.02  951.0984   890.8046
> print(head(dtChoice))
Key: <tract>
     tract neighbourhoodDescription      CTUID     ROLL_NUMBER
    <char>                   <char>     <char>          <char>
1: 0002.01               FRASERVIEW 9330002.01 025811276440000
2: 0002.03               FRASERVIEW 9330002.03 025816256430000
3: 0002.03               FRASERVIEW 9330002.03 025811244470000
4: 0002.03               FRASERVIEW 9330002.03 025258810400000
5: 0002.03               FRASERVIEW 9330002.03 025811244850000
6: 0003.01          SOUTH VANCOUVER 9330003.01 017817221050000
   zoning_classification zoning_category zoning_district    folioID
                  <char>          <char>          <char>     <char>
1: Residential Inclusive              R1            R1-1 A000003FF0
2: Residential Inclusive              R1            R1-1 A000003G0L
3: Residential Inclusive              R1            R1-1 A000003FD2
4: Residential Inclusive              R1            R1-1 A000003DBQ
5: Residential Inclusive              R1            R1-1 A000003FDD
6: Residential Inclusive              R1            R1-1 A000002FAF
    permitnumber permitnumbercreateddate    use MB_effective_year
          <char>                  <IDat> <char>            <char>
1: DB-2021-00140              2021-01-14 single              1962
2: DB-2021-06388              2021-12-04 single              1936
3: DB-2021-03726              2021-07-16 single              1947
4: DB-2017-03777              2017-07-18 single              2018
5: DB-2021-03749              2021-07-16 duplex              1975
6: DB-2019-04036              2019-09-09 single              1970
   MB_total_finished_area                                     address LANDAREA
                   <char>                                      <char>    <num>
1:                   2200   2714 E 56TH AVENUE, Vancouver, BC V5S 1Z7   1.9403
2:                   1920  2213 NEWPORT AVENUE, Vancouver, BC V5P 2J1   0.7852
3:                   1638    1947 NASSAU DRIVE, Vancouver, BC V5P 2B7   0.7852
4:                   2583 7032 STIRLING STREET, Vancouver, BC V5P 4H5   0.7852
5:                   2278    1985 NASSAU DRIVE, Vancouver, BC V5P 2B7   0.7852
6:                   2206     7696 ROSS STREET, Vancouver, BC V5X 4B9   0.5432
   landWidth landDepth             geo_point_2d   typeofwork
       <num>     <num>                   <char>       <char>
1:     32.61    124.04 49.2186956, -123.0521362 New Building
2:     33.00    112.00  49.215532, -123.0616419 New Building
3:     33.00    135.61 49.2192592, -123.0671843 New Building
4:     33.00    112.00 49.2195496, -123.0603171 New Building
5:     33.00    134.18  49.2192529, -123.066622 New Building
6:     33.00    116.80 49.2149217, -123.0829524 New Building
                                    applicant distToSingle distToLaneway
                                       <char>        <num>         <num>
1:        Vincent Wan DBA: Vincent Wan Design           NA    42.9872075
2:        Aman Sidhu DBA: JSS DEVELOPMENT LTD           NA     0.9987124
3:       Mumta Karra DBA: Karra Turner Design           NA     0.0000000
4:        Vincent Wan DBA: Vincent Wan Design           NA    24.6994274
5: Bhupinder (Raj) Singh DBA: Raj Home Design           NA            NA
6: Bhupinder (Raj) Singh DBA: Raj Home Design           NA    10.1189471
   nearestSinglePermit nearestLanewayPermit latitude longitude   east
                <char>               <char>    <num>     <num> <lgcl>
1:                <NA>        DB-2021-06569 49.21870 -123.0521   TRUE
2:                <NA>        DB-2021-05928 49.21553 -123.0616   TRUE
3:                <NA>        DB-2021-03729 49.21926 -123.0672   TRUE
4:                <NA>        DB-2017-03780 49.21955 -123.0603   TRUE
5:                <NA>                 <NA> 49.21925 -123.0666   TRUE
6:                <NA>        DB-2019-04039 49.21492 -123.0830   TRUE
     neighbourhood elasticity medianPPSF  year latDowntown lonDowntown
            <char>      <num>      <num> <int>       <num>       <num>
1:      Fraserview  0.3841524   406.8755  2021     49.2827   -123.1207
2:      Fraserview  0.3841524   406.8755  2021     49.2827   -123.1207
3:      Fraserview  0.3841524   406.8755  2021     49.2827   -123.1207
4:      Fraserview  0.3841524   406.8755  2017     49.2827   -123.1207
5:      Fraserview  0.3841524   406.8755  2021     49.2827   -123.1207
6: South Vancouver  0.3836674   405.9609  2019     49.2827   -123.1207
   distDowntown landArea duplexRatio single duplex  multi multiplex laneway
          <num>    <num>       <num> <lgcl> <lgcl> <lgcl>    <lgcl>  <lgcl>
1:     8694.035 4044.944    2.423526   TRUE  FALSE  FALSE     FALSE   FALSE
2:     8619.165 3696.000    2.423526   TRUE  FALSE  FALSE     FALSE    TRUE
3:     8059.807 4475.130    2.423526   TRUE  FALSE  FALSE     FALSE    TRUE
4:     8285.615 3696.000    2.423526   TRUE  FALSE  FALSE     FALSE   FALSE
5:     8080.287 4427.940    2.423526  FALSE   TRUE  FALSE     FALSE      NA
6:     8023.307 3854.400    2.422938   TRUE  FALSE  FALSE     FALSE    TRUE
                   GEO               DGUID
                <char>              <char>
1: 0002.01 - Vancouver 2021S05079330002.01
2: 0002.03 - Vancouver 2021S05079330002.03
3: 0002.03 - Vancouver 2021S05079330002.03
4: 0002.03 - Vancouver 2021S05079330002.03
5: 0002.03 - Vancouver 2021S05079330002.03
6: 0003.01 - Vancouver 2021S05079330003.01
                                                     incomeStat medianIncome
                                                         <char>        <int>
1: Median household total income (2020) (2020 constant dollars)        88000
2: Median household total income (2020) (2020 constant dollars)        91000
3: Median household total income (2020) (2020 constant dollars)        91000
4: Median household total income (2020) (2020 constant dollars)        91000
5: Median household total income (2020) (2020 constant dollars)        91000
6: Median household total income (2020) (2020 constant dollars)        94000
> print(nrow(dtChoice))
[1] 1648
> dtElasticityN[,neighbourhoodDescription:=toupper(NEIGHBOURHOOD)]
Error in eval(jsub, SDenv, parent.frame()) : 
  object 'NEIGHBOURHOOD' not found
Calls: [ -> [.data.table -> eval -> eval -> toupper
Execution halted
