
R version 4.5.0 (2025-04-11) -- "How About a Twenty-Six"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # bcaSales.R
> # R to use 2019 sales to get census-tract level coefficients on duplex vs single family and also square footage coefficients on ppsf
> # Tom Davidoff
> # 01/14/26
> 
> # strategy:
> # Get 2026 roll centroids, merge on roll/1000 (for subdivisions), confirm coverage for 2019 sales data (through 2018)
> # merge with census tract centroids
> # Regress coefficients, etc.
> 
> library(data.table)
> library(sf)
Linking to GEOS 3.13.0, GDAL 3.8.5, PROJ 9.5.1; sf_use_s2() is TRUE
> library(RSQLite)
> library(fixest)
> library(ggplot2)
> library(scales)

Attaching package: ‘scales’

The following object is masked from ‘package:fixest’:

    pvalue

> library(stringr)
> library(readxl)
> 
> BCA19    <- "~/OneDrive - UBC/dataRaw/REVD19_and_inventory_extracts.sqlite3"
> BCA26 <- "/Volumes/T7Office/bigFiles/bca_folios.gpkg"
> 
> # use 2026 data to get floor(roll number/1000) to get lot polygons -> centroid , maybe zoning 
> fRollLatLon <- "~/OneDrive - UBC/dataProcessed/bca26RollCensusTract.rds"
> fLaneway <-  "~/OneDrive - UBC/dataRaw/20231231_UBC_CustomLanewayReport.xlsx"
> 
> # drop duplex
> if (!file.exists(fRollLatLon)) {
+   cat("Extracting lot centroids from BCA 2026 data...\n")
+   desc26 <- st_read(BCA26,
+       layer="WHSE_HUMAN_CULTURAL_ECONOMIC_BCA_FOLIO_DESCRIPTIONS_SV",
+       query = "SELECT ROLL_NUMBER, geom FROM WHSE_HUMAN_CULTURAL_ECONOMIC_BCA_FOLIO_DESCRIPTIONS_SV WHERE JURISDICTION_CODE=='200' AND ACTUAL_USE_DESCRIPTION IN ('Residential Dwelling with Suite','Single Family Dwelling')  > 0", 
+       quiet = TRUE
+   )
+   print(head(desc26))
+   stDesc <- st_crs(desc26)
+   roll_pt <- st_point_on_surface(desc26)
+   # convert geom to centroid
+   # --- 2021 Census Tracts (cartographic) via download
+   ct_file <- "~/OneDrive - UBC/dataRaw/lct_000b21a_e/lct_000b21a_e.shp"
+   sCT <- st_read(ct_file, quiet = TRUE)
+   sCT <- st_make_valid(sCT)
+   sCT <- st_transform(sCT, stDesc)
+ 
+   roll_ct <- st_join(roll_pt, sCT[, c("CTUID", "DGUID", "CTNAME", "PRUID")], join = st_within, left = TRUE)
+   print(head(roll_ct))
+   saveRDS(roll_ct, fRollLatLon)
+ }
> 
> # Load BCA 2019 sales data (all residential)
> fSales <- "~/OneDrive - UBC/dataProcessed/bca19Sales.rds"
> if (!file.exists(fSales)) {
+   cat("Extracting BCA 2019 sales data...\n")
+   db <- dbConnect(SQLite(), BCA19)
+   dtBCA2019 <- as.data.table(dbGetQuery(db, "
+       SELECT s.folioID, s.conveyancePrice, s.conveyanceDate,
+              i.MB_effective_year, i.MB_total_finished_area, i.land_width, i.land_depth, i.land_area, i.roll_number, i.zoning,
+              d.actualUseDescription, d.neighbourhoodDescription, a.postalCode
+       FROM sales s
+       JOIN folio f ON s.folioID = f.folioID
+       JOIN residentialInventory i ON f.rollNumber = i.roll_number
+       JOIN folioDescription d ON f.folioID = d.folioID
+       JOIN address a ON f.folioID = a.folioID
+       WHERE s.conveyanceTypeDescription = 'Improved Single Property Transaction'
+         AND i.jurisdiction = 200
+         AND (d.actualUseDescription IN ('Residential Dwelling with Suite','Single Family Dwelling') OR INSTR(d.actualUseDescription, 'uplex') > 0)
+   "))
+   dbDisconnect(db)
+   saveRDS(dtBCA2019, fSales)
+ } 
> dtBCA2019 <- readRDS(fSales)
> print(head(dtBCA2019))
      folioID conveyancePrice conveyanceDate MB_effective_year
       <char>          <char>         <char>            <char>
1: A000000009         9450000     2014-06-16              2019
2: A00000000A         8800000     2013-02-08              1997
3: A00000000A         1700000     1991-07-09              1997
4: A00000000B         3850000     2006-12-04              1945
5: A00000000B          190000     1977-04-15              1945
6: A00000000C         2308000     1991-09-03              2011
   MB_total_finished_area land_width land_depth land_area     roll_number
                   <char>     <char>     <char>    <char>          <char>
1:                  11895                                 001019632060000
2:                   7760        195      251.9           001019632290000
3:                   7760        195      251.9           001019632290000
4:                   3215        150        250           001019632450000
5:                   3215        150        250           001019632450000
6:                   8673        150        250           001019632650000
   zoning   actualUseDescription neighbourhoodDescription postalCode
   <char>                 <char>                   <char>     <char>
1:    RS1 Single Family Dwelling               POINT GREY    V6T 1A9
2:    RS1 Single Family Dwelling               POINT GREY    V6T 1B2
3:    RS1 Single Family Dwelling               POINT GREY    V6T 1B2
4:    RS1 Single Family Dwelling               POINT GREY    V6T 1B2
5:    RS1 Single Family Dwelling               POINT GREY    V6T 1B2
6:    RS1 Single Family Dwelling               POINT GREY    V6T 1B2
> 
> # merge back with census tract on roll number/1000
> dtRollLatLon <- as.data.table(readRDS(fRollLatLon))
> dtBCA2019[, roll_base := floor(as.numeric(roll_number) / 1000)]
> dtRollLatLon[, roll_base := floor(as.numeric(ROLL_NUMBER) / 1000)]
> dtBCA2019 <- merge(dtBCA2019, dtRollLatLon[, .(roll_base, CTUID, DGUID, CTNAME)], by = "roll_base", all.x = TRUE)
> print(table(is.na(dtBCA2019[, CTUID])))

 FALSE   TRUE 
148653  10995 
> print(table(dtBCA2019[is.na(CTUID), actualUseDescription]))

2 Acres Or More (Single Family Dwelling, Duplex) 
                                              75 
 Duplex, Non-Strata Side by Side or Front / Back 
                                            2100 
                    Duplex, Non-Strata Up / Down 
                                             254 
                     Duplex, Strata Front / Back 
                                            4207 
                     Duplex, Strata Side by Side 
                                            2497 
                        Duplex, Strata Up / Down 
                                             239 
                 Residential Dwelling with Suite 
                                             753 
                          Single Family Dwelling 
                                             870 
> print(table(dtBCA2019[!is.na(CTUID), actualUseDescription]))

2 Acres Or More (Single Family Dwelling, Duplex) 
                                               2 
 Duplex, Non-Strata Side by Side or Front / Back 
                                               9 
                     Duplex, Strata Front / Back 
                                              18 
                 Residential Dwelling with Suite 
                                           78968 
                          Single Family Dwelling 
                                           69656 
> 
> 
> # Numeric conversion and cleaning
> cols <- c("conveyancePrice", "MB_effective_year", "MB_total_finished_area","land_area","land_width","land_depth")
> dtBCA2019[, (cols) := lapply(.SD, as.numeric), .SDcols = cols]
> dtBCA2019 <- dtBCA2019[!is.na(MB_total_finished_area) & conveyancePrice > 100000]
> dtBCA2019[, land_area_approximate := land_width * land_depth]
> dtBCA2019 <- dtBCA2019[!is.na(land_depth) & !is.na(land_width)]
> 
> # Metrics
> dtBCA2019[, `:=`(
+     age = year(conveyanceDate) - MB_effective_year, 
+     ppsf = conveyancePrice / MB_total_finished_area 
+ )]
> 
> # Outlier removal (global)
> CUT <- 0.05
> dtBCA2019 <- dtBCA2019[
+     age >= 0 &
+     MB_total_finished_area %between% quantile(MB_total_finished_area, c(CUT, 1-CUT)) &
+     ppsf %between% quantile(ppsf, c(CUT, 1-CUT))
+ ]
> 
> cat("BCA 2019 transactions loaded:", nrow(dtBCA2019), "\n")
BCA 2019 transactions loaded: 84520 
> 
> # ==========================================
> # Exclude from the sales homes with laneways
> # NO, don't because this is about MB slope
> # ==========================================
> 
> dtLaneway <- as.data.table(read_excel(fLaneway, sheet = "DATA"))
> setnames(dtLaneway, "ROLL_NUM", "Roll_Number_char")
> dtLaneway[, `:=`(
+   Roll_Number = as.numeric(Roll_Number_char),
+   roll_base = floor(as.numeric(Roll_Number_char) / 1000)
+ )]
> 
> dtBCA2019 <- merge(dtBCA2019, dtLaneway[, .(roll_base, lanewayBuilt = YEAR_BUILT)], by = "roll_base", all.x = TRUE)
> dtBCA2019[, hasLaneway := !is.na(lanewayBuilt) & (year(conveyanceDate) >= lanewayBuilt)]
> 
> MINYEAR <- 2012
> MEANYEAR <- 2015
> WIDTHCUT <- 0.15
> DEPTHMIN <- 110
> DEPTHMAX <- 150
> 
> dtBCA2019 <- dtBCA2019[grepl("RS", zoning)]
> # Exclude Shaughnessy and West End
> dtBCA2019 <- dtBCA2019[!neighbourhoodDescription %chin% c("SHAUGNESSY", "WEST END")]
> 
> # ==========================================
> # Function to run analysis at a given geographic level
> # ==========================================
> 
> runAnalysis <- function(dt, groupVar, label) {
+   cat("\n==========================================\n")
+   cat("Running analysis at", label, "level\n")
+   cat("==========================================\n")
+   
+   # Compute median land_width within each group
+   dt[, landWidthMedian := median(land_width, na.rm = TRUE), by = groupVar]
+   dt[, saleYear := year(conveyanceDate)]
+   
+   # Filter to observations near median width for that group
+   dtFiltered <- dt[
+     land_width >= landWidthMedian * (1 - WIDTHCUT) & 
+     land_width <= landWidthMedian * (1 + WIDTHCUT) &
+     land_depth >= DEPTHMIN & 
+     land_depth < DEPTHMAX
+   ]
+   
+   # Analysis sample: newer builds , post-MINYEAR
+   MAXAGE <- 15
+   dtAnalysis <- dtFiltered[age<15 & year(conveyanceDate) >= MINYEAR]
+   cat("Analysis sample size:", nrow(dtAnalysis), "\n")
+   
+   # Build formulas dynamically
+   fmlaMain <- as.formula(paste0(
+     "ppsf ~ i(", groupVar, ", MB_total_finished_area) + log(age + 1) + MB_total_finished_area + log(land_width) + log(land_depth) | ", groupVar
+   ))
+ 
+   fmlaLog <- as.formula(paste0(
+     "log(ppsf) ~ 0 + i(", groupVar, ", log(MB_total_finished_area)) + log(age + 1) + log(land_width) + log(land_depth) | saleYear + ", groupVar 
+   ))# no main effect for Wald purposes
+   
+   # Run regressions
+   mainReg <- feols(fmlaMain, data = dtAnalysis)
+   print(r2(mainReg, typ = c("r2", "ar2")))
+   
+   logReg <- feols(fmlaLog, data = dtAnalysis)
+   print(r2(logReg, typ = c("r2", "ar2")))
+ 
+   # Extract slopes
+   dtSlopes <- as.data.table(coeftable(mainReg), keep.rownames = "term")[grepl("MB_total_finished_area", term)]
+   # Extract group identifier from term
+   pattern <- paste0(groupVar, "::(.*):MB_total_finished_area")
+   dtSlopes[, (groupVar) := gsub(pattern, "\\1", term)]
+   
+   # Extract elasticities
+   dtElasticities <- as.data.table(coeftable(logReg), keep.rownames = "term")[grepl("log\\(MB_total_finished_area\\)", term)]
+   patternLog <- paste0(groupVar, "::(.*):log\\(MB_total_finished_area\\)")
+   dtElasticities[, (groupVar) := gsub(patternLog, "\\1", term)]
+   
+   # Compute means, adjust for CPI
+   dtCPI <- fread("~/OneDrive - UBC/dataRaw/1810000501_databaseLoadingData.csv",select=c("REF_DATE","VALUE","Products and product groups"))
+   dtCPI <- dtCPI[`Products and product groups` == "All-items"]
+   setnames(dtCPI, c("REF_DATE", "VALUE"), c("year", "CPI"))
+   dtCPI[,CPI:=CPI / CPI[year==2025]]
+   dtFiltered <- merge(dtFiltered, dtCPI, by.x = "saleYear", by.y = "year", all.x = TRUE)
+   print(head(dtFiltered))
+   print(head(dtCPI))
+ 
+   dtMeans <- dtFiltered[hasLaneway == FALSE & year(conveyanceDate) >= MEANYEAR, 
+                         .(meanPPSF = mean(ppsf/CPI, na.rm = TRUE), nobs = .N), 
+                         by = groupVar]
+   
+   # Merge slopes and elasticities
+   dtMeans <- merge(dtMeans, dtSlopes[, c(groupVar, "Estimate"), with = FALSE], by = groupVar, all.x = TRUE)
+   setnames(dtMeans, "Estimate", "slope")
+   dtMeans <- merge(dtMeans, dtElasticities[, c(groupVar, "Estimate"), with = FALSE], by = groupVar, all.x = TRUE)
+   setnames(dtMeans, "Estimate", "elasticity")
+   
+   # Output
+   fwrite(dtMeans, paste0("~/OneDrive - UBC/dataProcessed/bca19_mean_ppsf_slope_by_", label, ".csv"))
+   
+   # Plot
+   p <- ggplot(dtMeans[nobs > quantile(nobs, .025) & !is.na(slope)], aes(x = slope, y = meanPPSF)) + 
+     geom_point() + 
+     geom_smooth(method = "lm") + 
+     labs(title = paste("Mean BCA Price per SqFt vs Pricing Slope by", label), 
+          x = "BCA Pricing Slope ($/sqft per sqft)", 
+          y = "Mean Price per SqFt")
+   ggsave(paste0("text/bca19_mean_ppsf_vs_slope_", label, ".png"), plot = p)
+   
+   # Correlations
+   cat("\nCorrelations (", label, "):\n", sep = "")
+   print(cor(dtMeans[!is.na(slope), .(slope, meanPPSF)]))
+   print(cor(dtMeans[!is.na(elasticity), .(elasticity, meanPPSF)]))
+   print(cor(dtMeans[!is.na(slope) & nobs > quantile(nobs, .025), .(slope, meanPPSF)]))
+   print(cor(dtMeans[!is.na(elasticity) & nobs > quantile(nobs, .05), .(elasticity, meanPPSF)]))
+   print(cor(dtMeans[!is.na(elasticity) & nobs > quantile(nobs, .1), .(elasticity, meanPPSF)]))
+   print(summary(dtMeans[!is.na(elasticity) & nobs > quantile(nobs, .025), .(elasticity, meanPPSF)]))
+   print(summary(dtMeans[!is.na(elasticity) & nobs > quantile(nobs, .05), .(elasticity, meanPPSF)]))
+   print(summary(dtMeans[!is.na(elasticity) & nobs > quantile(nobs, .1), .(elasticity, meanPPSF)]))
+   
+   return(dtMeans)
+ }
> 
> # ==========================================
> # Run analyses
> # ==========================================
> 
> dtResultsTract <- runAnalysis(copy(dtBCA2019), "CTUID", "tract")

==========================================
Running analysis at tract level
==========================================
Analysis sample size: 3081 
NOTE: 1 observation removed because of NA values (RHS: 1, Fixed-effects: 1).
The variables 'CTUID::9330001.02:MB_total_finished_area', 'CTUID::9330017.02:MB_total_finished_area', 'CTUID::9330021.00:MB_total_finished_area', 'CTUID::9330032.02:MB_total_finished_area' and 'MB_total_finished_area' have been removed because of collinearity (see $collin.var).
       r2       ar2 
0.3645173 0.3328840 
NOTE: 1 observation removed because of NA values (RHS: 1, Fixed-effects: 1).
The variables 'CTUID::9330001.02:log(MB_total_finished_area)', 'CTUID::9330017.02:log(MB_total_finished_area)', 'CTUID::9330021.00:log(MB_total_finished_area)' and 'CTUID::9330032.02:log(MB_total_finished_area)' have been removed because of collinearity (see $collin.var).
       r2       ar2 
0.6720355 0.6548863 
Key: <saleYear>
   saleYear   roll_base    folioID conveyancePrice conveyanceDate
      <int>       <num>     <char>           <num>         <char>
1:     1974 11161792870 A000001DFJ          137500     1974-07-15
2:     1976 11765152610 A000001EGL          129000     1976-08-15
3:     1977  4707070530 A000000MZL          108000     1977-12-15
4:     1977  5733073310 A000000QRZ          152000     1977-09-15
5:     1977 11152757590 A000001D6Z          145000     1977-07-15
6:     1978  3707037570 A000000HPH          131000     1978-12-15
   MB_effective_year MB_total_finished_area land_width land_depth land_area
               <num>                  <num>      <num>      <num>     <num>
1:              1959                   2205       57.0      120.0        NA
2:              1963                   2310       56.0      122.5        NA
3:              1977                   1900       33.0      122.0        NA
4:              1976                   2707       60.0      130.0        NA
5:              1963                   2593       62.5      120.0        NA
6:              1978                   2078       33.0      122.1        NA
       roll_number zoning   actualUseDescription  neighbourhoodDescription
            <char> <char>                 <char>                    <char>
1: 011161792870000    RS1 Single Family Dwelling                  OAKRIDGE
2: 011765152610000    RS1 Single Family Dwelling                  OAKRIDGE
3: 004707070530000    RS1 Single Family Dwelling ARBUTUS/MACKENZIE HEIGHTS
4: 005733073310000    RS5 Single Family Dwelling                KERRISDALE
5: 011152757590000    RS1 Single Family Dwelling                  OAKRIDGE
6: 003707037570000    RS5 Single Family Dwelling                    DUNBAR
   postalCode      CTUID               DGUID  CTNAME land_area_approximate
       <char>     <char>              <char>  <char>                 <num>
1:    V6P 3N4 9330010.02 2021S05079330010.02 0010.02                6840.0
2:    V5Z 2R7 9330010.01 2021S05079330010.01 0010.01                6860.0
3:    V6L 1R2 9330026.00 2021S05079330026.00 0026.00                4026.0
4:    V6N 2L9 9330027.02 2021S05079330027.02 0027.02                7800.0
5:    V5Z 3W8 9330010.01 2021S05079330010.01 0010.01                7500.0
6:    V6S 1L7 9330025.00 2021S05079330025.00 0025.00                4029.3
     age     ppsf lanewayBuilt hasLaneway landWidthMedian       CPI
   <num>    <num>        <num>     <lgcl>           <num>     <num>
1:    15 62.35828           NA      FALSE            57.0 0.1595615
2:    13 55.84416           NA      FALSE            60.1 0.1894032
3:     0 56.84211           NA      FALSE            37.0 0.2046285
4:     1 56.15072           NA      FALSE            60.0 0.2046285
5:    14 55.91978           NA      FALSE            60.1 0.2046285
6:     0 63.04139           NA      FALSE            33.0 0.2228989
   Products and product groups
                        <char>
1:                   All-items
2:                   All-items
3:                   All-items
4:                   All-items
5:                   All-items
6:                   All-items
    year        CPI Products and product groups
   <int>      <num>                      <char>
1:  1960 0.09439708                   All-items
2:  1961 0.09561510                   All-items
3:  1962 0.09683313                   All-items
4:  1963 0.09805116                   All-items
5:  1964 0.09987820                   All-items
6:  1965 0.10231425                   All-items
Saving 7 x 7 in image
`geom_smooth()` using formula = 'y ~ x'

Correlations (tract):
             slope  meanPPSF
slope    1.0000000 0.1501751
meanPPSF 0.1501751 1.0000000
           elasticity  meanPPSF
elasticity  1.0000000 0.3392742
meanPPSF    0.3392742 1.0000000
             slope  meanPPSF
slope    1.0000000 0.1501751
meanPPSF 0.1501751 1.0000000
           elasticity  meanPPSF
elasticity  1.0000000 0.3287942
meanPPSF    0.3287942 1.0000000
           elasticity  meanPPSF
elasticity  1.0000000 0.3903182
meanPPSF    0.3903182 1.0000000
   elasticity           meanPPSF     
 Min.   :-1.081182   Min.   : 747.5  
 1st Qu.:-0.549168   1st Qu.: 821.4  
 Median :-0.356534   Median : 866.3  
 Mean   :-0.247091   Mean   : 897.7  
 3rd Qu.: 0.008195   3rd Qu.: 991.2  
 Max.   : 1.305754   Max.   :1097.0  
   elasticity           meanPPSF     
 Min.   :-1.081182   Min.   : 747.5  
 1st Qu.:-0.543790   1st Qu.: 823.8  
 Median :-0.350039   Median : 871.9  
 Mean   :-0.238933   Mean   : 899.1  
 3rd Qu.: 0.009613   3rd Qu.: 991.8  
 Max.   : 1.305754   Max.   :1097.0  
   elasticity          meanPPSF     
 Min.   :-1.08118   Min.   : 747.5  
 1st Qu.:-0.54286   1st Qu.: 821.4  
 Median :-0.33999   Median : 855.8  
 Mean   :-0.22765   Mean   : 895.1  
 3rd Qu.: 0.02895   3rd Qu.: 991.2  
 Max.   : 1.30575   Max.   :1097.0  
> dtResultsNbhd <- runAnalysis(copy(dtBCA2019), "neighbourhoodDescription", "neighbourhood")

==========================================
Running analysis at neighbourhood level
==========================================
Analysis sample size: 2949 
       r2       ar2 
0.2832575 0.2716453 
       r2       ar2 
0.6495260 0.6431097 
Key: <saleYear>
   saleYear   roll_base    folioID conveyancePrice conveyanceDate
      <int>       <num>     <char>           <num>         <char>
1:     1974 11161792870 A000001DFJ          137500     1974-07-15
2:     1976 11765152610 A000001EGL          129000     1976-08-15
3:     1978  3707037570 A000000HPH          131000     1978-12-15
4:     1978  3726040500 A000000JUD          108000     1978-03-15
5:     1978  6034750460 A000000T2K          183000     1978-06-15
6:     1978  6791036180 A000000U7C          165000     1978-04-15
   MB_effective_year MB_total_finished_area land_width land_depth land_area
               <num>                  <num>      <num>      <num>     <num>
1:              1959                   2205         57      120.0        NA
2:              1963                   2310         56      122.5        NA
3:              1978                   2078         33      122.1        NA
4:              1978                   1747         33      130.8        NA
5:              1977                   2955         66      116.5        NA
6:              1977                   2836         66      136.0        NA
       roll_number zoning   actualUseDescription neighbourhoodDescription
            <char> <char>                 <char>                   <char>
1: 011161792870000    RS1 Single Family Dwelling                 OAKRIDGE
2: 011765152610000    RS1 Single Family Dwelling                 OAKRIDGE
3: 003707037570000    RS5 Single Family Dwelling                   DUNBAR
4: 003726040500000    RS5 Single Family Dwelling                   DUNBAR
5: 006034750460000    RS5 Single Family Dwelling               SOUTHLANDS
6: 006791036180000    RS6 Single Family Dwelling               SOUTHLANDS
   postalCode      CTUID               DGUID  CTNAME land_area_approximate
       <char>     <char>              <char>  <char>                 <num>
1:    V6P 3N4 9330010.02 2021S05079330010.02 0010.02                6840.0
2:    V5Z 2R7 9330010.01 2021S05079330010.01 0010.01                6860.0
3:    V6S 1L7 9330025.00 2021S05079330025.00 0025.00                4029.3
4:    V6S 1Z2 9330024.00 2021S05079330024.00 0024.00                4316.4
5:    V6N 2A4 9330008.02 2021S05079330008.02 0008.02                7689.0
6:    V6N 3T8 9330008.02 2021S05079330008.02 0008.02                8976.0
     age     ppsf lanewayBuilt hasLaneway landWidthMedian       CPI
   <num>    <num>        <num>     <lgcl>           <num>     <num>
1:    15 62.35828           NA      FALSE           54.00 0.1595615
2:    13 55.84416           NA      FALSE           54.00 0.1894032
3:     0 63.04139           NA      FALSE           33.65 0.2228989
4:     0 61.82026           NA      FALSE           33.65 0.2228989
5:     1 61.92893           NA      FALSE           60.00 0.2228989
6:     1 58.18054           NA      FALSE           60.00 0.2228989
   Products and product groups
                        <char>
1:                   All-items
2:                   All-items
3:                   All-items
4:                   All-items
5:                   All-items
6:                   All-items
    year        CPI Products and product groups
   <int>      <num>                      <char>
1:  1960 0.09439708                   All-items
2:  1961 0.09561510                   All-items
3:  1962 0.09683313                   All-items
4:  1963 0.09805116                   All-items
5:  1964 0.09987820                   All-items
6:  1965 0.10231425                   All-items
Saving 7 x 7 in image
`geom_smooth()` using formula = 'y ~ x'

Correlations (neighbourhood):
             slope  meanPPSF
slope    1.0000000 0.2456097
meanPPSF 0.2456097 1.0000000
           elasticity  meanPPSF
elasticity  1.0000000 0.6932651
meanPPSF    0.6932651 1.0000000
             slope  meanPPSF
slope    1.0000000 0.2456097
meanPPSF 0.2456097 1.0000000
           elasticity  meanPPSF
elasticity  1.0000000 0.6737718
meanPPSF    0.6737718 1.0000000
           elasticity  meanPPSF
elasticity  1.0000000 0.6529039
meanPPSF    0.6529039 1.0000000
   elasticity         meanPPSF     
 Min.   :-0.6430   Min.   : 781.9  
 1st Qu.:-0.4102   1st Qu.: 824.0  
 Median :-0.2765   Median : 937.1  
 Mean   :-0.0735   Mean   : 928.2  
 3rd Qu.: 0.2781   3rd Qu.:1007.7  
 Max.   : 0.9667   Max.   :1066.7  
   elasticity         meanPPSF     
 Min.   :-0.6430   Min.   : 781.9  
 1st Qu.:-0.4139   1st Qu.: 819.8  
 Median :-0.3211   Median : 907.7  
 Mean   :-0.1137   Mean   : 923.3  
 3rd Qu.: 0.2507   3rd Qu.:1002.3  
 Max.   : 0.9667   Max.   :1066.7  
   elasticity         meanPPSF     
 Min.   :-0.6430   Min.   : 781.9  
 1st Qu.:-0.4179   1st Qu.: 819.3  
 Median :-0.3371   Median : 903.8  
 Mean   :-0.1345   Mean   : 916.8  
 3rd Qu.: 0.1882   3rd Qu.:1001.8  
 Max.   : 0.9667   Max.   :1066.7  
> 
> q("no")
> proc.time()
   user  system elapsed 
  9.007   2.372   3.441 
